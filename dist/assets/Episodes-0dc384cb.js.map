{"version":3,"file":"Episodes-0dc384cb.js","sources":["../../src/components/lists/EpisodeList.vue","../../src/components/pages/Episodes.vue"],"sourcesContent":["<template>\n<div class=\"data-list\">\n  <div\n    class=\"datatable-wrapper\"\n    ref=\"body\"\n    v-scroll=\"onBodyScroll\"\n  >\n\n    <table-header-menu\n      ref=\"headerMenu\"\n      :is-minimized=\"hiddenColumns[lastHeaderMenuDisplayed]\"\n      :is-edit-allowed=\"isCurrentUserManager\"\n      :is-sticked=\"stickedColumns[lastHeaderMenuDisplayed]\"\n      @minimize-clicked=\"onMinimizeColumnToggled()\"\n      @delete-all-clicked=\"onDeleteAllTasksClicked()\"\n      @sort-by-clicked=\"onSortByTaskTypeClicked()\"\n      @select-column=\"onSelectColumn\"\n      @toggle-stick=\"stickColumnClicked()\"\n    />\n\n    <table-metadata-header-menu\n      ref=\"headerMetadataMenu\"\n      :is-episode-allowed=\"\n        isMetadataColumnEditAllowed(lastMetadaDataHeaderMenuDisplayed)\"\n      :is-sticked=\"stickedColumns[lastMetadaDataHeaderMenuDisplayed]\"\n      @edit-clicked=\"onEpisodeMetadataClicked()\"\n      @delete-clicked=\"onDeleteMetadataClicked()\"\n      @sort-by-clicked=\"onSortByMetadataClicked()\"\n      @toggle-stick=\"metadataStickColumnClicked($event)\"\n    />\n\n    <table class=\"datatable\">\n      <thead\n        class=\"datatable-head\"\n        id=\"datatable-episode\"\n        v-columns-resizable\n      >\n        <tr>\n          <th\n            scope=\"col\"\n            class=\"name episode-name datatable-row-header\"\n            ref=\"th-episode\"\n          >\n            <div class=\"flexrow\">\n              <span class=\"flexrow-item\">\n                {{ $t('episodes.fields.name') }}\n              </span>\n              <button-simple\n                class=\"is-small flexrow-item\"\n                icon=\"plus\"\n                :text=\"''\"\n                @click=\"onAddMetadataClicked\"\n                v-if=\"(isCurrentUserManager || isCurrentUserSupervisor)\n                  && !isLoading\"\n              />\n            </div>\n          </th>\n          <metadata-header\n            :ref=\"`editor-${j}`\"\n            :key=\"descriptor.id\"\n            :descriptor=\"descriptor\"\n            :left=\"offsets['editor-' + j] ? `${offsets['editor-' + j]}px` : '0'\"\n            is-stick\n            @show-metadata-header-menu=\"event => showMetadataHeaderMenu(descriptor.id, event)\"\n            v-for=\"(descriptor, j) in stickedVisibleMetadataDescriptors\"\n            v-if=\"isShowInfos\"\n          />\n          <validation-header\n            :ref=\"`validation-${columnIndexInGrid}`\"\n            :key=\"columnId\"\n            :hidden-columns=\"hiddenColumns\"\n            :column-id=\"columnId\"\n            :validation-style=\"getValidationStyle(columnId)\"\n            :left=\"offsets['validation-' + columnIndexInGrid] ? `${offsets['validation-' + columnIndexInGrid]}px` : '0'\"\n            type=\"editor\"\n            is-stick\n            @show-header-menu=\"event => showHeaderMenu(columnId, columnIndexInGrid, event)\"\n            v-for=\"(columnId, columnIndexInGrid) in stickedDisplayedValidationColumns\"\n            v-if=\"!isLoading\"\n          />\n\n          <th\n            scope=\"col\"\n            class=\"description selectable\"\n            v-if=\"!isCurrentUserClient && isShowInfos && isEpisodeDescription\"\n          >\n            {{ $t('episodes.fields.description') }}\n          </th>\n\n          <metadata-header\n            :key=\"descriptor.id\"\n            :descriptor=\"descriptor\"\n            @show-metadata-header-menu=\"event => showMetadataHeaderMenu(descriptor.id, event)\"\n            v-for=\"descriptor in nonStickedVisibleMetadataDescriptors\"\n            v-if=\"isShowInfos\"\n          />\n          <th\n            scope=\"col\"\n            class=\"time-spent\"\n            ref=\"th-spent\"\n            v-if=\"!isCurrentUserClient &&\n                  isShowInfos &&\n                  isEpisodeTime &&\n                  metadataDisplayHeaders.timeSpent\"\n          >\n            {{ $t('episodes.fields.time_spent') }}\n          </th>\n          <th\n            scope=\"col\"\n            class=\"estimation\"\n            :title=\"$t('main.estimation')\"\n            ref=\"th-spent\"\n            v-if=\"!isCurrentUserClient &&\n                  isShowInfos &&\n                  isEpisodeEstimation &&\n                  metadataDisplayHeaders.estimation\"\n          >\n            {{ $t('main.estimation_short') }}\n          </th>\n          <th\n            scope=\"col\"\n            class=\"status\"\n            ref=\"th-status\"\n            v-if=\"isShowInfos &&\n                  metadataDisplayHeaders.status\"\n          >\n            {{ $t('main.status') }}\n          </th>\n\n          <validation-header\n            :key=\"columnId\"\n            :hidden-columns=\"hiddenColumns\"\n            :column-id=\"columnId\"\n            :validation-style=\"getValidationStyle(columnId)\"\n            type=\"episodes\"\n            @show-header-menu=\"event => {\n              showHeaderMenu(columnId, columnIndexInGrid, event)\n            }\"\n            v-for=\"(columnId, columnIndexInGrid) in nonStickedDisplayedValidationColumns\"\n            v-if=\"!isLoading\"\n          />\n          <th scope=\"col\" class=\"actions\" ref=\"actionsSection\">\n            <button-simple\n              :class=\"{\n                'is-small': true,\n                highlighted: isEmptyTask\n              }\"\n              icon=\"plus\"\n              :text=\"$t('tasks.create_tasks')\"\n              @click=\"$emit('create-tasks')\"\n              v-if=\"isCurrentUserManager &&\n                    displayedEpisodes.length > 0 &&\n                    !isLoading\"\n            />\n\n            <table-metadata-selector-menu\n              ref=\"headerMetadataSelectorMenu\"\n              :metadataDisplayHeaders.sync=\"metadataDisplayHeaders\"\n              :descriptors=\"episodeMetadataDescriptors\"\n              :exclude=\"{\n                timeSpent: !isEpisodeTime,\n                estimation: !isEpisodeEstimation\n              }\"\n              namespace=\"episodes\"\n              v-show=\"columnSelectorDisplayed && isShowInfos\"\n            />\n\n            <button-simple\n              class=\"is-small is-pulled-right\"\n              icon=\"down\"\n              @click=\"toggleColumnSelector\"\n              v-if=\"episodeMetadataDescriptors.length > 0 && isShowInfos\"\n            />\n          </th>\n        </tr>\n      </thead>\n      <tbody class=\"datatable-body\">\n        <tr\n          class=\"datatable-row\"\n          scope=\"row\"\n          :key=\"episode.id\"\n          :class=\"{canceled: episode.canceled}\"\n          v-for=\"(episode, i) in displayedEpisodes\"\n          v-if=\"!isLoading && isListVisible\"\n        >\n          <th\n            :class=\"{\n              'datatable-row-header': true,\n              'episode-name': true,\n              name: true,\n              strong: !episode.canceled\n            }\"\n          >\n            <div class=\"flexrow\">\n              <entity-thumbnail\n                :entity=\"episode\"\n                :width=\"isBigThumbnails ? 150 : 50\"\n                :height=\"isBigThumbnails ? 100 : 33\"\n                :empty-width=\"isBigThumbnails ? 150 : 50\"\n                :empty-height=\"isBigThumbnails ? 100 : 34\"\n              />\n              <router-link\n                tabindex=\"-1\"\n                :title=\"episode.name\"\n                :to=\"episodePath(episode.id)\"\n              >\n                {{ episode.name }}\n              </router-link>\n            </div>\n          </th>\n\n          <!-- Metadata stick -->\n          <td\n            :ref=\"`editor-${i}-${j}`\"\n            class=\"metadata-descriptor datatable-row-header\"\n            :title=\"episode.data ? episode.data[descriptor.field_name] : ''\"\n            :style=\"{'left': offsets['editor-' + j] ? `${offsets['editor-' + j]}px` : '0'}\"\n            :key=\"episode.id + '-' + descriptor.id\"\n            v-for=\"(descriptor, j) in stickedVisibleMetadataDescriptors\"\n            v-if=\"isShowInfos\"\n          >\n            <input\n              class=\"input-editor\"\n              @input=\"event => onMetadataFieldChanged(episode, descriptor, event)\"\n              @keyup.ctrl=\"event => onInputKeyUp(event, i, j)\"\n              :value=\"getMetadataFieldValue(descriptor, episode)\"\n              v-if=\"descriptor.choices.length === 0 && (isCurrentUserManager\n              || isSupervisorInDepartments(descriptor.departments))\"\n            />\n            <span\n              class=\"select\"\n              v-else-if=\"isCurrentUserManager\n              || isSupervisorInDepartments(descriptor.departments)\"\n            >\n            <select\n              class=\"select-input\"\n              @keyup.ctrl=\"event => onInputKeyUp(event, i, j)\"\n              @change=\"event => onMetadataFieldChanged(episode, descriptor, event)\"\n            >\n              <option\n                v-for=\"(option, i) in getDescriptorChoicesOptions(descriptor)\"\n                :key=\"`${episode.id}-${descriptor.id}-${i}-${option.label}-${option.value}`\"\n                :value=\"option.value\"\n                :selected=\"getMetadataFieldValue(descriptor, episode) === option.value\"\n              >\n                {{ option.label }}\n              </option>\n            </select>\n            </span>\n              <span class=\"metadata-value selectable\" v-else>\n              {{ getMetadataFieldValue(descriptor, episode) }}\n            </span>\n          </td>\n\n          <validation-cell\n            :ref=\"`validation-${i}-${j}`\"\n            :key=\"columnId + '-' + episode.id\"\n            :class=\"{\n              'validation-cell': !hiddenColumns[columnId],\n              'hidden-validation-cell': hiddenColumns[columnId],\n              'datatable-row-header': true\n            }\"\n            :column=\"taskTypeMap.get(columnId)\"\n            :columnY=\"j\"\n            :entity=\"episode\"\n            :is-assignees=\"isShowAssignations\"\n            :is-static=\"true\"\n            :left=\"offsets['validation-' + j] ? `${offsets['validation-' + j]}px` : '0'\"\n            :minimized=\"hiddenColumns[columnId]\"\n            :rowX=\"i\"\n            :selected=\"isSelected(i, j)\"\n            :sticked=\"true\"\n            :task-test=\"taskMap.get(episode.validations.get(columnId))\"\n            @select=\"(infos) => onTaskSelected(infos, true)\"\n            @unselect=\"(infos) => onTaskUnselected(infos, true)\"\n            v-for=\"(columnId, j) in stickedDisplayedValidationColumns\"\n            v-if=\"!isLoading\"\n          />\n\n          <description-cell\n            class=\"description\"\n            :entry=\"episode\"\n            :editable=\"isCurrentUserManager\"\n            @description-changed=\"value => onDescriptionChanged(episode, value)\"\n            v-if=\"!isCurrentUserClient && isShowInfos && isEpisodeDescription\"\n          />\n\n          <!-- other Metadata cells -->\n          <td\n            class=\"metadata-descriptor\"\n            :title=\"episode.data ? episode.data[descriptor.field_name] : ''\"\n            :key=\"episode.id + '-' + descriptor.id\"\n            v-for=\"(descriptor, j) in nonStickedVisibleMetadataDescriptors\"\n            v-if=\"isShowInfos\"\n          >\n            <input\n              class=\"input-editor\"\n              @input=\"event => onMetadataFieldChanged(episode, descriptor, event)\"\n              @keyup.ctrl=\"event => onInputKeyUp(event, i, j)\"\n              :value=\"getMetadataFieldValue(descriptor, episode)\"\n              v-if=\"descriptor.choices.length === 0 && (isCurrentUserManager\n              || isSupervisorInDepartments(descriptor.departments))\"\n            />\n            <span\n              class=\"select\"\n              v-else-if=\"isCurrentUserManager\n              || isSupervisorInDepartments(descriptor.departments)\"\n            >\n            <select\n              class=\"select-input\"\n              @keyup.ctrl=\"event => onInputKeyUp(event, i, j)\"\n              @change=\"event => onMetadataFieldChanged(episode, descriptor, event)\"\n            >\n              <option\n                v-for=\"(option, i) in getDescriptorChoicesOptions(descriptor)\"\n                :key=\"`${episode.id}-${descriptor.id}-${i}-${option.label}-${option.value}`\"\n                :value=\"option.value\"\n                :selected=\"getMetadataFieldValue(descriptor, episode) === option.value\"\n              >\n                {{ option.label }}\n              </option>\n            </select>\n            </span>\n              <span class=\"metadata-value selectable\" v-else>\n              {{ getMetadataFieldValue(descriptor, episode) }}\n            </span>\n          </td>\n\n          <td\n            class=\"time-spent selectable\"\n            v-if=\"!isCurrentUserClient && isShowInfos && isEpisodeTime && metadataDisplayHeaders.timeSpent\"\n          >\n            {{ formatDuration(episode.timeSpent) }}\n          </td>\n\n          <td\n            class=\"estimation selectable\"\n            v-if=\"!isCurrentUserClient && isShowInfos && isEpisodeEstimation && metadataDisplayHeaders.estimation\"\n          >\n            {{ formatDuration(episode.estimation) }}\n          </td>\n\n          <td\n            scope=\"col\"\n            class=\"status metadata-descriptor\"\n            ref=\"th-status\"\n            v-if=\"isShowInfos &&\n                  metadataDisplayHeaders.status\"\n          >\n            <span class=\"select\">\n              <select\n                class=\"select-input\"\n                @change=\"event => onEpisodeStatusChanged(episode, event.target.value)\"\n              >\n                <option\n                  v-for=\"option in episodeStatusOptions\"\n                  :key=\"`${episode.id}-status-option-${option.value}`\"\n                  :value=\"option.value\"\n                  :selected=\"(episode.status || 'running') === option.value\"\n                >\n                  {{ $t('episodes.status.' + option.label) }}\n                </option>\n              </select>\n            </span>\n          </td>\n\n          <validation-cell\n            :ref=\"`validation-${i}-${j + stickedDisplayedValidationColumns.length}`\"\n            :class=\"{\n              'validation-cell': !hiddenColumns[columnId],\n              'hidden-validation-cell': hiddenColumns[columnId]\n            }\"\n            :key=\"`${columnId}-${episode.id}`\"\n            :column=\"taskTypeMap.get(columnId)\"\n            :entity=\"episode\"\n            :task-test=\"taskMap.get(episode.validations\n                        ? episode.validations.get(columnId)\n                        : null\n            )\"\n            :minimized=\"hiddenColumns[columnId]\"\n            :selected=\"isSelected(i, j + stickedDisplayedValidationColumns.length)\"\n            :rowX=\"i\"\n            :columnY=\"j\"\n            :is-assignees=\"isShowAssignations\"\n            @select=\"onTaskSelected\"\n            @unselect=\"onTaskUnselected\"\n            v-for=\"(columnId, j) in nonStickedDisplayedValidationColumns\"\n            v-if=\"!isLoading\"\n          />\n          <row-actions-cell\n            :entry=\"episode\"\n            @delete-clicked=\"$emit('delete-clicked', episode)\"\n            @edit-clicked=\"$emit('edit-clicked', episode)\"\n            v-if=\"isCurrentUserManager\"\n          />\n          <td class=\"actions\" v-else></td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n\n  <table-info\n    :is-loading=\"isLoading\"\n    :is-error=\"isError\"\n  />\n\n  <div\n    class=\"has-text-centered\"\n    v-if=\"isEmptyList && isCurrentUserClient && !isLoading\"\n  >\n    <p class=\"info\">\n      <img src=\"../../assets/illustrations/empty_shot.png\" />\n    </p>\n    <p class=\"info\">{{ $t('episodes.empty_list_client') }}</p>\n  </div>\n\n  <p\n    class=\"has-text-centered nb-episodes\"\n    v-if=\"!isEmptyList && !isLoading\"\n  >\n    {{ displayedEpisodesLength }} {{ $tc('episodes.number', displayedEpisodesLength) }}\n    <span\n      v-if=\"displayedEpisodesTimeSpent > 0 && displayedEpisodesEstimation > 0\"\n    >\n    ({{ formatDuration(displayedEpisodesTimeSpent) }}\n     {{ $tc('main.days_spent', displayedEpisodesTimeSpent) }},\n     {{ formatDuration(displayedEpisodesEstimation) }}\n     {{ $tc('main.man_days', displayedEpisodesEstimation) }})\n    </span>\n  </p>\n\n</div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nimport { descriptorMixin } from '@/components/mixins/descriptors'\nimport { domMixin } from '@/components/mixins/dom'\nimport { entityListMixin } from '@/components/mixins/entity_list'\nimport { formatListMixin } from '@/components/mixins/format'\nimport { selectionListMixin } from '@/components/mixins/selection'\n\nimport ButtonSimple from '@/components/widgets/ButtonSimple'\nimport DescriptionCell from '@/components/cells/DescriptionCell'\nimport EntityThumbnail from '@/components/widgets/EntityThumbnail'\nimport MetadataHeader from '@/components/cells/MetadataHeader'\nimport RowActionsCell from '@/components/cells/RowActionsCell'\nimport TableMetadataHeaderMenu from '@/components/widgets/TableMetadataHeaderMenu'\nimport TableMetadataSelectorMenu from '@/components/widgets/TableMetadataSelectorMenu'\nimport TableHeaderMenu from '@/components/widgets/TableHeaderMenu'\nimport TableInfo from '@/components/widgets/TableInfo'\nimport ValidationCell from '@/components/cells/ValidationCell'\nimport ValidationHeader from '@/components/cells/ValidationHeader'\n\nexport default {\n  name: 'episode-list',\n  mixins: [\n    descriptorMixin,\n    domMixin,\n    formatListMixin,\n    entityListMixin,\n    selectionListMixin\n  ],\n\n  props: {\n    displayedEpisodes: {\n      type: Array,\n      default: () => []\n    },\n    isError: {\n      type: Boolean,\n      default: false\n    },\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    validationColumns: {\n      type: Array,\n      default: () => []\n    },\n    departmentFilter: {\n      type: Array,\n      default: () => []\n    }\n  },\n\n  data () {\n    return {\n      type: 'episode',\n      hiddenColumns: {},\n      lastHeaderMenuDisplayed: null,\n      lastMetadaDataHeaderMenuDisplayed: null,\n      lastHeaderMenuDisplayedIndexInGrid: null,\n      lastSelectedEpisode: null,\n      lastSelection: null,\n      metadataDisplayHeaders: {\n        estimation: true,\n        timeSpent: true,\n        status: true\n      },\n      offsets: {},\n      stickedColumns: {},\n      episodeStatusOptions: [\n        { label: 'canceled', value: 'canceled' },\n        { label: 'complete', value: 'complete' },\n        { label: 'running', value: 'running' },\n        { label: 'standby', value: 'standby' }\n      ]\n    }\n  },\n\n  components: {\n    ButtonSimple,\n    DescriptionCell,\n    EntityThumbnail,\n    MetadataHeader,\n    RowActionsCell,\n    TableHeaderMenu,\n    TableMetadataHeaderMenu,\n    TableMetadataSelectorMenu,\n    TableInfo,\n    ValidationCell,\n    ValidationHeader\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentProduction',\n      'episodeMap',\n      'episodeFilledColumns',\n      'episodeMetadataDescriptors',\n      'episodes',\n      'episodeSearchText',\n      'episodeSelectionGrid',\n      'currentEpisode',\n      'displayedEpisodesEstimation',\n      'displayedEpisodesLength',\n      'displayedEpisodesTimeSpent',\n      'isBigThumbnails',\n      'isCurrentUserAdmin',\n      'isCurrentUserManager',\n      'isCurrentUserSupervisor',\n      'isCurrentUserClient',\n      'isSingleEpisode',\n      'isEpisodeDescription',\n      'isEpisodeEstimation',\n      'isEpisodeTime',\n      'isShowAssignations',\n      'isShowInfos',\n      'nbSelectedTasks',\n      'taskMap',\n      'taskTypeMap',\n      'user'\n    ]),\n\n    isEmptyList () {\n      return (\n        this.displayedEpisodes.length &&\n        this.displayedEpisodes[0].length === 0 &&\n        !this.isLoading &&\n        !this.isError &&\n        (!this.episodeSearchText || this.episodeSearchText.length === 0)\n      )\n    },\n\n    isListVisible () {\n      return (\n        !this.isLoading &&\n        !this.isError &&\n        (\n          this.displayedEpisodesLength > 0\n        )\n      )\n    },\n\n    visibleColumns () {\n      let count = 2\n      count += !this.isCurrentUserClient &&\n        this.isShowInfos &&\n        this.isEpisodeDescription\n        ? 1\n        : 0\n      count += this.visibleMetadataDescriptors.length\n      count += !this.isCurrentUserClient &&\n        this.isShowInfos &&\n        this.isEpisodeTime && this.metadataDisplayHeaders.timeSpent\n        ? 1\n        : 0\n      count += !this.isCurrentUserClient &&\n        this.isShowInfos &&\n        this.isEpisodeEstimation && this.metadataDisplayHeaders.estimation\n        ? 1\n        : 0\n      count += this.displayedValidationColumns.length\n      return count\n    },\n\n    displayedValidationColumns () {\n      return this.validationColumns.filter((columnId) => {\n        return this.episodeFilledColumns[columnId] &&\n          (!this.hiddenColumns[columnId] || this.isShowInfos)\n      })\n    },\n\n    metadataDescriptors () {\n      return this.episodeMetadataDescriptors\n    },\n\n    localStorageStickKey () {\n      return `stick-episodes-${this.currentProduction.id}`\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'setEpisodeSelection'\n    ]),\n\n    isSelected (lineIndex, columnIndex) {\n      return (\n        this.episodeSelectionGrid[lineIndex] &&\n        this.episodeSelectionGrid[lineIndex][columnIndex]\n      )\n    },\n\n    episodePath (episodeId) {\n      return this.getPath('episode', episodeId)\n    },\n\n    getPath (section, episodeId) {\n      const route = {\n        name: section,\n        params: {\n          production_id: this.currentProduction.id\n        }\n      }\n      if (episodeId) {\n        route.params.episode_id = episodeId\n      }\n      return route\n    },\n\n    onEpisodeStatusChanged (episode, status) {\n      this.$emit('field-changed', {\n        entry: episode,\n        fieldName: 'status',\n        value: status\n      })\n    }\n  },\n\n  watch: {\n    displayedEpisodes () {\n      this.$options.lineIndex = {}\n    },\n\n    validationColumns () {\n      this.initHiddenColumns(this.validationColumns, this.hiddenColumns)\n    },\n\n    stickedColumns () {\n      this.updateOffsets()\n    },\n\n    isLoading () {\n      this.updateOffsets()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.dark {\n  th .input-editor,\n  td .select select,\n  td .input-editor {\n    color: $white;\n\n    option {\n      background: $dark-grey-light;\n      color: $white;\n    }\n\n    &:focus,\n    &:active,\n    &:hover {\n      background: $dark-grey-light;\n    }\n  }\n}\n\n.project {\n  min-width: 60px;\n  width: 60px;\n}\n\n.actions {\n  min-width: 160px;\n  position: sticky;\n}\n\nth.actions {\n  padding: 0.4em;\n}\n\n.name {\n  min-width: 100px;\n  width: 100px;\n}\n\n.name a {\n  color: inherit;\n}\n\n.name.episode-name {\n  min-width: 110px;\n  width: 110px;\n}\n\n.description {\n  min-width: 200px;\n  max-width: 200px;\n  width: 200px;\n}\n\n.status {\n  min-width: 120px;\n  max-width: 120px;\n  width: 120px;\n}\n\n.validation-cell {\n  min-width: 150px;\n  max-width: 150px;\n  width: 150px;\n}\n\n.estimation,\n.time-spent {\n  min-width: 70px;\n  max-width: 70px;\n  width: 70px;\n}\n\ntd.name {\n  font-size: 1.2em;\n}\n\nspan.thumbnail-empty {\n  display: block;\n  width: 50px;\n  height: 30px;\n  background: #F3F3F3;\n}\n\n.info {\n  margin-top: 2em;\n}\n\n.info img {\n  max-width: 80vh;\n}\n\n.datatable-row th.name {\n  font-size: 1.1em;\n  padding: 6px;\n}\n\n.datatable-row-header {\n  cursor: pointer;\n}\n\nth .input-editor,\ntd .input-editor {\n  color: $grey-strong;\n  height: 100%;\n  padding: 0.5rem;\n  width: 100%;\n  background: transparent;\n  border: 1px solid transparent;\n  z-index: 100;\n\n  &:active,\n  &:focus,\n  &:hover {\n    background: transparent;\n    background: white;\n  }\n\n  &:active,\n  &:focus {\n    border: 1px solid $green;\n  }\n\n  &:hover {\n    border: 1px solid $light-green;\n  }\n}\n\ninput[type=\"number\"]::-webkit-outer-spin-button,\ninput[type=\"number\"]::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n    margin: 0;\n}\n\ninput[type=\"number\"] {\n    -moz-appearance: textfield;\n}\n\n// Metadata cell CSS\n\ntd.metadata-descriptor {\n  height: 3.1rem;\n  padding: 0;\n}\n\ntd .select {\n  color: $grey-strong;\n  margin: 0;\n  height: 100%;\n  width: 100%;\n  border: 1px solid transparent;\n\n  &::after {\n    border-color: transparent;\n  }\n\n  &:active,\n  &:focus,\n  &:hover {\n    &::after {\n      border-color: $green;\n    }\n  }\n\n  select {\n    color: $grey-strong;\n    height: 100%;\n    width: 100%;\n    background: transparent;\n    border-radius: 0;\n    border: 1px solid transparent;\n\n    &:focus {\n      border: 1px solid $green;\n      background: white;\n    }\n\n    &:hover {\n      background: transparent;\n      background: white;\n      border: 1px solid $light-green;\n    }\n  }\n}\n\n.metadata-value {\n  padding: 0.8rem;\n}\n\nth .input-editor,\ntd .input-editor {\n  color: $grey-strong;\n  height: 100%;\n  padding: 0.5rem;\n  width: 100%;\n  background: transparent;\n  border: 1px solid transparent;\n  z-index: 100;\n\n  &:active,\n  &:focus,\n  &:hover {\n    background: transparent;\n    background: white;\n  }\n\n  &:active,\n  &:focus {\n    border: 1px solid $green;\n  }\n\n  &:hover {\n    border: 1px solid $light-green;\n  }\n}\n\n\ntd .select {\n  color: $grey-strong;\n  margin: 0;\n  height: 100%;\n  width: 100%;\n  border: 1px solid transparent;\n\n  &::after {\n    border-color: transparent;\n  }\n\n  &:active,\n  &:focus,\n  &:hover {\n    &::after {\n      border-color: $green;\n    }\n  }\n\n  select {\n    color: $grey-strong;\n    height: 100%;\n    width: 100%;\n    background: transparent;\n    border-radius: 0;\n    border: 1px solid transparent;\n\n    &:focus {\n      border: 1px solid $green;\n      background: white;\n    }\n\n    &:hover {\n      background: transparent;\n      background: white;\n      border: 1px solid $light-green;\n    }\n  }\n}\n</style>\n","<template>\n<div class=\"columns fixed-page\">\n  <action-panel />\n\n  <div class=\"column main-column\">\n    <div class=\"episodes page\">\n      <div class=\"episode-list-header page-header\">\n        <div class=\"flexrow\">\n          <search-field\n            ref=\"episode-search-field\"\n            :can-save=\"true\"\n            :active=\"isSearchActive\"\n            @change=\"onSearchChange\"\n            @enter=\"saveSearchQuery\"\n            @save=\"saveSearchQuery\"\n            placeholder=\"ex: e01 episode=wip\"\n          />\n          <button-simple\n            class=\"flexrow-item\"\n            :title=\"$t('entities.build_filter.title')\"\n            icon=\"funnel\"\n            @click=\"() => modals.isBuildFilterDisplayed = true\"\n          />\n          <div class=\"filler\"></div>\n          <div class=\"flexrow flexrow-item\" v-if=\"!isCurrentUserClient\">\n            <show-assignations-button class=\"flexrow-item\" />\n            <show-infos-button class=\"flexrow-item\" />\n            <big-thumbnails-button class=\"flexrow-item\" />\n          </div>\n          <div class=\"flexrow\" v-if=\"isCurrentUserManager\">\n            <button-simple\n              class=\"flexrow-item\"\n              :text=\"$t('episodes.new_episode')\"\n              icon=\"plus\"\n              @click=\"showNewModal\"\n            />\n          </div>\n        </div>\n\n        <div class=\"query-list mt1\">\n          <search-query-list\n            :queries=\"episodeSearchQueries\"\n            @change-search=\"changeSearch\"\n            @remove-search=\"removeSearchQuery\"\n            v-if=\"!isEpisodesLoading && !initialLoading\"\n          />\n        </div>\n      </div>\n\n      <sorting-info\n        :label=\"$t('main.sorted_by')\"\n        :sorting=\"episodeSorting\"\n        @clear-sorting=\"onChangeSortClicked(null)\"\n        v-if=\"episodeSorting && episodeSorting.length > 0\"\n      />\n\n      <episode-list\n        ref=\"episode-list\"\n        :displayed-episodes=\"displayedEpisodes\"\n        :is-loading=\"isEpisodesLoading || initialLoading\"\n        :is-error=\"isEpisodesLoadingError\"\n        :validation-columns=\"episodeValidationColumns\"\n        :department-filter=\"departmentFilter\"\n        @add-metadata=\"onAddMetadataClicked\"\n        @change-sort=\"onChangeSortClicked\"\n        @create-tasks=\"showCreateTasksModal\"\n        @delete-all-tasks=\"onDeleteAllTasksClicked\"\n        @delete-clicked=\"onDeleteClicked\"\n        @delete-metadata=\"onDeleteMetadataClicked\"\n        @edit-clicked=\"onEditClicked\"\n        @edit-metadata=\"onEditMetadataClicked\"\n        @field-changed=\"onFieldChanged\"\n        @metadata-changed=\"onMetadataChanged\"\n        @scroll=\"saveScrollPosition\"\n      />\n    </div>\n  </div>\n\n  <div\n    id=\"side-column\"\n    class=\"column side-column\"\n    v-show=\"nbSelectedTasks === 1\"\n  >\n    <task-info\n      :task=\"selectedTasks.values().next().value\"\n    />\n  </div>\n\n  <edit-episode-modal\n    :active=\"modals.isNewDisplayed\"\n    :is-loading=\"loading.episode\"\n    :is-error=\"errors.episode\"\n    :episode-to-episode=\"episodeToEdit\"\n    @cancel=\"modals.isNewDisplayed = false\"\n    @confirm=\"confirmEditEpisode\"\n  />\n\n  <delete-modal\n    ref=\"delete-episode-modal\"\n    :active=\"modals.isDeleteDisplayed\"\n    :is-loading=\"loading.del\"\n    :is-error=\"errors.del\"\n    :text=\"deleteText()\"\n    :error-text=\"$t('episodes.delete_error')\"\n    @cancel=\"modals.isDeleteDisplayed = false\"\n    @confirm=\"confirmDeleteEpisode\"\n  />\n\n  <delete-modal\n    ref=\"delete-metadata-modal\"\n    :active=\"modals.isDeleteMetadataDisplayed\"\n    :is-loading=\"loading.deleteMetadata\"\n    :is-error=\"errors.deleteMetadata\"\n    :text=\"$t('productions.metadata.delete_text')\"\n    :error-text=\"$t('productions.metadata.delete_error')\"\n    @cancel=\"modals.isDeleteMetadataDisplayed = false\"\n    @confirm=\"confirmDeleteMetadata\"\n  />\n\n  <hard-delete-modal\n    ref=\"delete-all-tasks-modal\"\n    :active=\"modals.isDeleteAllTasksDisplayed\"\n    :is-loading=\"loading.deleteAllTasks\"\n    :is-error=\"errors.deleteAllTasks\"\n    :text=\"deleteAllTasksText()\"\n    :error-text=\"$t('tasks.delete_all_error')\"\n    :lock-text=\"deleteAllTasksLockText\"\n    :selection-option=\"true\"\n    @cancel=\"modals.isDeleteAllTasksDisplayed = false\"\n    @confirm=\"confirmDeleteAllTasks\"\n  />\n\n  <create-tasks-modal\n    :active=\"modals.isCreateTasksDisplayed\"\n    :is-loading=\"loading.creatingTasks\"\n    :is-loading-stay=\"loading.creatingTasksStay\"\n    :is-error=\"errors.creatingTasks\"\n    :title=\"$t('tasks.create_tasks_episode')\"\n    :text=\"$t('tasks.create_tasks_episode_explaination')\"\n    :error-text=\"$t('tasks.create_tasks_episode_failed')\"\n    @cancel=\"hideCreateTasksModal\"\n    @confirm=\"confirmCreateTasks\"\n    @confirm-and-stay=\"confirmCreateTasksAndStay\"\n  />\n\n  <add-metadata-modal\n    :active=\"modals.isAddMetadataDisplayed\"\n    :is-loading=\"loading.addMetadata\"\n    :is-loading-stay=\"loading.addMetadata\"\n    :is-error=\"errors.addMetadata\"\n    :descriptor-to-edit=\"descriptorToEdit\"\n    entity-type=\"Episode\"\n    @cancel=\"closeMetadataModal\"\n    @confirm=\"confirmAddMetadata\"\n  />\n\n  <add-thumbnails-modal\n    ref=\"add-thumbnails-modal\"\n    parent=\"episodes\"\n    :active=\"modals.isAddThumbnailsDisplayed\"\n    :is-loading=\"loading.addThumbnails\"\n    :is-error=\"errors.addThumbnails\"\n    @cancel=\"hideAddThumbnailsModal\"\n    @confirm=\"confirmAddThumbnails\"\n  />\n\n  <build-filter-modal\n    ref=\"build-filter-modal\"\n    :active=\"modals.isBuildFilterDisplayed\"\n    entity-type=\"episode\"\n    @cancel=\"modals.isBuildFilterDisplayed = false\"\n    @confirm=\"confirmBuildFilter\"\n  />\n\n  <edit-episode-modal\n    :active=\"modals.isNewDisplayed\"\n    :is-loading=\"loading.edit\"\n    :is-error=\"errors.edit\"\n    :episode-to-edit=\"episodeToEdit\"\n    @cancel=\"modals.isNewDisplayed = false\"\n    @confirm=\"confirmEditEpisode\"\n  />\n\n  <hard-delete-modal\n    :active=\"modals.isDeleteDisplayed\"\n    :is-loading=\"loading.del\"\n    :is-error=\"errors.del\"\n    :text=\"deleteText()\"\n    :error-text=\"$t('episodes.delete_error')\"\n    :lock-text=\"episodeToDelete ? episodeToDelete.name : ''\"\n    @cancel=\"modals.isDeleteDisplayed = false\"\n    @confirm=\"confirmDeleteEpisode\"\n  />\n</div>\n</template>\n\n<script>\nimport moment from 'moment'\nimport { mapGetters, mapActions } from 'vuex'\nimport csv from '@/lib/csv'\nimport { sortByName } from '@/lib/sorting'\nimport stringHelpers from '@/lib/string'\n\nimport { searchMixin } from '@/components/mixins/search'\nimport { entitiesMixin } from '@/components/mixins/entities'\n\nimport AddMetadataModal from '@/components/modals/AddMetadataModal'\nimport AddThumbnailsModal from '@/components/modals/AddThumbnailsModal'\nimport ActionPanel from '@/components/tops/ActionPanel'\nimport BigThumbnailsButton from '@/components/widgets/BigThumbnailsButton'\nimport BuildFilterModal from '@/components/modals/BuildFilterModal'\nimport ButtonSimple from '@/components/widgets/ButtonSimple'\nimport CreateTasksModal from '@/components/modals/CreateTasksModal'\nimport DeleteModal from '@/components/modals/DeleteModal'\nimport EditEpisodeModal from '@/components/modals/EditEpisodeModal'\nimport EpisodeList from '@/components/lists/EpisodeList.vue'\nimport HardDeleteModal from '@/components/modals/HardDeleteModal'\nimport SearchField from '@/components/widgets/SearchField'\nimport SearchQueryList from '@/components/widgets/SearchQueryList'\nimport SortingInfo from '@/components/widgets/SortingInfo'\nimport ShowAssignationsButton from '@/components/widgets/ShowAssignationsButton'\nimport ShowInfosButton from '@/components/widgets/ShowInfosButton'\nimport TaskInfo from '@/components/sides/TaskInfo.vue'\n\nexport default {\n  name: 'episodes',\n  mixins: [searchMixin, entitiesMixin],\n\n  components: {\n    ActionPanel,\n    AddMetadataModal,\n    AddThumbnailsModal,\n    BigThumbnailsButton,\n    BuildFilterModal,\n    ButtonSimple,\n    CreateTasksModal,\n    DeleteModal,\n    EditEpisodeModal,\n    EpisodeList,\n    HardDeleteModal,\n    SearchField,\n    SearchQueryList,\n    SortingInfo,\n    ShowAssignationsButton,\n    ShowInfosButton,\n    TaskInfo\n  },\n\n  data () {\n    return {\n      type: 'episode',\n      deleteAllTasksLockText: null,\n      descriptorToEdit: {},\n      departmentFilter: [],\n      episodeToDelete: null,\n      episodeToEdit: null,\n      formData: null,\n      genericColumns: [\n        'metadata_column_name => text value',\n        'task_type_name => task_status_name',\n        'task_type_name comment => comment text'\n      ],\n      historyEdit: {},\n      initialLoading: true,\n      isSearchActive: false,\n      optionalColumns: [\n        'Description'\n      ],\n      pageName: 'Episodes',\n      parsedCSV: [],\n      selectedDepartment: 'ALL',\n      taskTypeForTaskDeletion: null,\n      modals: {\n        isAddMetadataDisplayed: false,\n        isAddThumbnailsDisplayed: false,\n        isBuildFilterDisplayed: false,\n        isCreateTasksDisplayed: false,\n        isDeleteDisplayed: false,\n        isDeleteMetadataDisplayed: false,\n        isDeleteAllTasksDisplayed: false,\n        isImportRenderDisplayed: false,\n        isImportDisplayed: false,\n        isNewDisplayed: false\n      },\n      loading: {\n        addMetadata: false,\n        addThumbnails: false,\n        creatingTasks: false,\n        creatingTasksStay: false,\n        deleteAllTasks: false,\n        deleteMetadata: false,\n        episode: false,\n        del: false,\n        importing: false,\n        stay: false\n      },\n      errors: {\n        addMetadata: false,\n        deleteMetadata: false,\n        creatingTasks: false,\n        deleteAllTasks: false,\n        importing: false,\n        importingError: null\n      }\n    }\n  },\n\n  beforeDestroy () {\n    this.clearSelectedEpisodes()\n  },\n\n  created () {\n    this.setLastProductionScreen('episodes')\n  },\n\n  mounted () {\n    let searchQuery = ''\n    if (this.episodeSearchText && this.episodeSearchText.length > 0) {\n      this.searchField.setValue(this.episodeSearchText)\n    }\n    if (this.$route.query.search && this.$route.query.search.length > 0) {\n      searchQuery = '' + this.$route.query.search\n    }\n    if (searchQuery === 'undefined') searchQuery = ''\n    this.$refs['episode-list'].setScrollPosition(\n      this.episodeListScrollPosition\n    )\n    this.onSearchChange()\n    this.$refs['episode-list'].setScrollPosition(\n      this.episodeListScrollPosition\n    )\n    if (!this.isCurrentUserManager && this.user.departments.length > 0) {\n      this.selectedDepartment = 'MY_DEPARTMENTS'\n      this.departmentFilter = this.user.departments\n    } else {\n      this.departmentFilter = []\n    }\n\n    const finalize = () => {\n      this.initialLoading = false\n      if (this.$refs['episode-list']) {\n        this.$refs['episode-search-field'].setValue(searchQuery)\n        this.onSearchChange()\n        this.$refs['episode-list'].setScrollPosition(\n          this.episodeListScrollPosition\n        )\n      }\n    }\n\n    if (\n      this.episodeMap.size < 1 ||\n      this.episodeValidationColumns.length === 0 ||\n      this.episodeMap.values().next().project_id !== this.currentProduction.id\n    ) {\n      this.loadEpisodesWithTasks()\n        .then(() => {\n          this.initialLoading = false\n        })\n        .catch(console.error)\n    } else {\n      if (!this.isEpisodesLoading) this.initialLoading = false\n      finalize()\n    }\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentEpisode',\n      'currentProduction',\n      'displayedEpisodes',\n      'departments',\n      'episodeMap',\n      'episodes',\n      'episodeSearchQueries',\n      'isCurrentUserClient',\n      'isCurrentUserManager',\n      'isEpisodeDescription',\n      'isEpisodeEstimation',\n      'isEpisodeTime',\n      'isEpisodesLoading',\n      'isEpisodesLoadingError',\n      'isShowAssignations',\n      'isTVShow',\n      'nbSelectedTasks',\n      'openProductions',\n      'selectedTasks',\n      'episodeMap',\n      'episodeFilledColumns',\n      'episodesCsvFormData',\n      'episodeSearchText',\n      'episodeValidationColumns',\n      'episodeListScrollPosition',\n      'episodeSorting',\n      'taskTypeMap',\n      'user',\n      'departmentMap',\n      'productionEpisodeTaskTypes'\n    ]),\n\n    renderColumns () {\n      var collection = [...this.dataMatchers, ...this.optionalColumns]\n\n      this.productionEpisodeTaskTypes.forEach(item => {\n        collection.push(item.name)\n        collection.push(item.name + ' comment')\n      })\n      return collection\n    },\n\n    filteredEpisodes () {\n      const episodes = {}\n      this.displayedEpisodes.forEach(episode => {\n        const episodeKey = episode.name\n        episodes[episodeKey] = true\n      })\n      return episodes\n    },\n\n    metadataDescriptors () {\n      return this.episodeMetadataDescriptors\n    }\n  },\n\n  methods: {\n    ...mapActions([\n      'addMetadataDescriptor',\n      'createTasks',\n      'changeEpisodeSort',\n      'clearSelectedEpisodes',\n      'commentTaskWithPreview',\n      'deleteAllTasks',\n      'deleteEpisode',\n      'deleteMetadataDescriptor',\n      'editEpisode',\n      'getEpisodesCsvLines',\n      'hideAssignations',\n      'loadEpisodesWithTasks',\n      'newEpisode',\n      'removeEpisodeSearch',\n      'saveEpisodeSearch',\n      'setLastProductionScreen',\n      'setPreview',\n      'setEpisodeSearch',\n      'showAssignations',\n      'uploadEpisodeFile'\n    ]),\n\n    confirmAddMetadata (form) {\n      this.loading.addMetadata = true\n      form.entity_type = 'Episode'\n      this.addMetadataDescriptor(form)\n        .then(() => {\n          this.loading.addMetadata = false\n          this.modals.isAddMetadataDisplayed = false\n        })\n        .catch((err) => {\n          console.error(err)\n          this.loading.addMetadata = false\n          this.errors.addMetadata = true\n        })\n    },\n\n    showNewModal () {\n      this.episodeToEdit = {}\n      this.modals.isNewDisplayed = true\n    },\n\n    confirmDeleteEpisode () {\n      this.loading.del = true\n      this.errors.del = false\n      this.deleteEpisode(this.episodeToDelete)\n        .then(() => {\n          this.loading.del = false\n          this.modals.isDeleteDisplayed = false\n        })\n        .catch(err => {\n          console.error(err)\n          this.loading.del = false\n          this.errors.del = true\n        })\n    },\n\n    runTasksCreation (form, selectionOnly) {\n      this.errors.creatingTasks = false\n      return this.createTasks({\n        type: 'episodes',\n        task_type_id: form.task_type_id,\n        project_id: this.currentProduction.id,\n        selectionOnly\n      })\n    },\n\n    reset () {\n      this.initialLoading = false\n      this.loadEpisodesWithTasks((err) => {\n        if (err) console.error(err)\n        this.initialLoading = false\n      })\n    },\n\n    resetEditModal () {\n      const form = { name: '' }\n      if (this.openProductions.length > 0) {\n        form.production_id = this.openProductions[0].id\n      }\n      this.episodeToEdit = form\n    },\n\n    applySearch (searchQuery) {\n      this.setEpisodeSearch(searchQuery)\n      this.setSearchInUrl()\n      this.isSearchActive = true\n    },\n\n    saveSearchQuery (searchQuery) {\n      this.saveEpisodeSearch(searchQuery)\n        .catch(console.error)\n    },\n\n    removeSearchQuery (searchQuery) {\n      this.removeEpisodeSearch(searchQuery)\n        .catch(console.error)\n    },\n\n    onExportClick () {\n      this.getEpisodesCsvLines()\n        .then(episodeLines => {\n          const nameData = [\n            moment().format('YYYY-MM-DD'),\n            'kitsu',\n            this.currentProduction.name,\n            this.$t('episodes.title')\n          ]\n          const name = stringHelpers.slugify(nameData.join('_'))\n          const headers = [\n            this.$t('episodes.fields.name'),\n            this.$t('episodes.fields.description')\n          ]\n          if (this.currentEpisode) {\n            headers.splice(0, 0, 'Episode')\n          }\n          sortByName([...this.currentProduction.descriptors])\n            .filter(d => d.entity_type === 'Episode')\n            .forEach((descriptor) => {\n              headers.push(descriptor.name)\n            })\n          if (this.isEpisodeTime) {\n            headers.push(this.$t('episodes.fields.time_spent'))\n          }\n          if (this.isEpisodeEstimation) {\n            headers.push(this.$t('main.estimation_short'))\n          }\n          this.episodeValidationColumns\n            .forEach(taskTypeId => {\n              headers.push(this.taskTypeMap.get(taskTypeId).name)\n              headers.push('Assignations')\n            })\n          csv.buildCsvFile(name, [headers].concat(episodeLines))\n        })\n    },\n\n    onFieldChanged ({ entry, fieldName, value }) {\n      const data = {\n        id: entry.id,\n        description: entry.description\n      }\n      data[fieldName] = value\n      this.editEpisode(data)\n    },\n\n    onMetadataChanged ({ entry, descriptor, value }) {\n      const metadata = {}\n      metadata[descriptor.field_name] = value\n      const data = {\n        id: entry.id,\n        data: metadata\n      }\n      this.editEpisode(data)\n    },\n\n    onEditClicked (episode) {\n      this.episodeToEdit = episode\n      this.modals.isNewDisplayed = true\n    },\n\n    onDeleteClicked (episode) {\n      this.episodeToDelete = episode\n      this.modals.isDeleteDisplayed = true\n    },\n\n    confirmEditEpisode (form) {\n      this.loading.edit = true\n      this.errors.edit = false\n\n      if (form.id) {\n        this.editEpisode(form)\n          .then(() => {\n            this.loading.edit = false\n            this.modals.isNewDisplayed = false\n          })\n          .catch(() => {\n            this.loading.edit = false\n            this.errors.edit = true\n          })\n      } else {\n        form.project_id = this.currentProduction.id\n        this.newEpisode(form)\n          .then(() => {\n            this.loading.edit = false\n            this.modals.isNewDisplayed = false\n          })\n          .catch(() => {\n            this.loading.edit = false\n            this.errors.edit = true\n          })\n      }\n    },\n\n    deleteText () {\n      const episode = this.episodeToDelete\n      if (episode) {\n        return this.$t('episodes.delete_text', { name: episode.name })\n      } else {\n        return ''\n      }\n    }\n  },\n\n  watch: {\n    $route () {\n      if (!this.$route.query) return\n      const search = this.$route.query.search\n      const actualSearch = this.$refs['episode-search-field'].getValue()\n      if (search !== actualSearch) {\n        this.searchField.setValue(search)\n        this.applySearch(search)\n      }\n    },\n\n    currentProduction () {\n      this.$refs['episode-search-field'].setValue('')\n      this.$store.commit('SET_EDIT_LIST_SCROLL_POSITION', 0)\n      this.initialLoading = false\n      this.reset()\n    },\n\n    isEpisodesLoading () {\n      if (!this.isEpisodesLoading) {\n        let searchQuery = ''\n        if (\n          this.$route.query.search &&\n          this.$route.query.search.length > 0\n        ) {\n          searchQuery = '' + this.$route.query.search\n        }\n        this.initialLoading = false\n        this.$refs['episode-search-field'].setValue(searchQuery)\n        this.$nextTick(() => {\n          this.applySearch(searchQuery)\n        })\n        if (this.$refs['episode-list']) {\n          this.$refs['episode-list'].setScrollPosition(\n            this.episodeListScrollPosition\n          )\n        }\n      }\n    }\n  },\n\n  metaInfo () {\n    return {\n      title: `${this.currentProduction.name} ${this.$t('episodes.title')} - Kitsu`\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.data-list {\n  margin-top: 0;\n}\n\n.page-header {\n  margin-bottom: 1em;\n}\n\n.flexcolumn {\n  align-items: flex-start;\n}\n\n.episodes {\n  display: flex;\n  flex-direction: column;\n}\n\n.columns {\n  display: flex;\n  flex-direction: row;\n  padding: 0;\n}\n\n.column {\n  overflow-y: auto;\n  padding: 0;\n}\n\n.main-column {\n  border-right: 3px solid $light-grey;\n}\n</style>\n"],"names":["_sfc_main","descriptorMixin","domMixin","formatListMixin","entityListMixin","selectionListMixin","ButtonSimple","DescriptionCell","EntityThumbnail","MetadataHeader","RowActionsCell","TableHeaderMenu","TableMetadataHeaderMenu","TableMetadataSelectorMenu","TableInfo","ValidationCell","ValidationHeader","mapGetters","count","columnId","mapActions","lineIndex","columnIndex","episodeId","section","route","episode","status","searchMixin","entitiesMixin","ActionPanel","AddMetadataModal","AddThumbnailsModal","BigThumbnailsButton","BuildFilterModal","CreateTasksModal","DeleteModal","EditEpisodeModal","EpisodeList","HardDeleteModal","SearchField","SearchQueryList","SortingInfo","ShowAssignationsButton","ShowInfosButton","TaskInfo","searchQuery","finalize","collection","item","episodes","episodeKey","form","err","selectionOnly","episodeLines","nameData","moment","name","stringHelpers","headers","sortByName","d","descriptor","taskTypeId","csv","entry","fieldName","value","data","metadata","search","actualSearch"],"mappings":"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"}