import{aO as l,R as n,a as c,m as a,b as r,n as d,a4 as u,aP as p,a8 as _}from"./index-d0b155bb.js";import{B as h}from"./ButtonLink-5dffc1d2.js";const f={name:"production-list",props:{entries:{type:Array,default:()=>[]},isError:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},data(){return{}},components:{ProductionNameCell:l,RowActionsCell:n,TableInfo:c},computed:{...a(["openProductions","lastProductionScreen"]),closedProductions(){return this.entries.filter(o=>o.project_status_name==="Closed")}},methods:{...r([]),getStatusLocale(o){return{Active:"productions.status.open",Open:"productions.status.open",Closed:"productions.status.closed"}[o]}}};var m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"data-list"},[e("div",{staticClass:"datatable-wrapper"},[e("table",{staticClass:"datatable multi-section"},[e("thead",{staticClass:"datatable-head"},[e("tr",[e("th",{staticClass:"name datatable-row-header",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("productions.fields.name"))+" ")]),e("th",{staticClass:"type",attrs:{scope:"col"}},[t._v(t._s(t.$t("productions.fields.type")))]),e("th",{staticClass:"style",attrs:{scope:"col"}},[t._v(t._s(t.$t("productions.fields.style")))]),e("th",{staticClass:"fps",attrs:{scope:"col"}},[t._v(t._s(t.$t("productions.fields.fps")))]),e("th",{staticClass:"ratio",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("productions.fields.ratio"))+" ")]),e("th",{staticClass:"resolution",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("productions.fields.resolution"))+" ")]),e("th",{staticClass:"actions",attrs:{scope:"col"}})])]),e("tbody",{staticClass:"datatable-body"},[e("tr",{staticClass:"datatable-type-header"},[e("th",{attrs:{scope:"rowgroup",colspan:"6"}},[e("span",{staticClass:"datatable-row-header"},[t._v(" "+t._s(t.$t("productions.status.open"))+" ")])])]),t._l(t.openProductions,function(s){return e("tr",{key:s.id,staticClass:"datatable-row"},[e("th",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[e("production-name-cell",{attrs:{"with-avatar":!0,entry:s,"last-production-screen":t.lastProductionScreen}})],1),e("td",{staticClass:"type"},[t._v(" "+t._s(t.$t("productions.type."+(s.production_type||"short")))+" ")]),e("td",{staticClass:"style"},[t._v(" "+t._s(t.$t("productions.style."+(s.production_style||"3d")))+" ")]),e("td",{staticClass:"fps"},[t._v(" "+t._s(s.fps)+" ")]),e("td",{staticClass:"ratio"},[t._v(" "+t._s(s.ratio)+" ")]),e("td",{staticClass:"resolution"},[t._v(" "+t._s(s.resolution)+" ")]),e("row-actions-cell",{attrs:{"entry-id":s.id,"hide-delete":!0},on:{"edit-clicked":function(i){return t.$emit("edit-clicked",s)}}})],1)})],2),t.closedProductions.length>0?e("tbody",[e("tr",{staticClass:"datatable-type-header"},[e("th",{attrs:{scope:"rowgroup",colspan:"6"}},[e("span",{staticClass:"datatable-row-header"},[t._v(" "+t._s(t.$t("productions.status.closed"))+" ")])])]),t._l(t.closedProductions,function(s){return e("tr",{key:s.id,staticClass:"datatable-row"},[e("th",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[e("production-name-cell",{attrs:{"with-avatar":!0,entry:s,"last-production-screen":t.lastProductionScreen,"is-link":!1}})],1),e("td",{staticClass:"type"},[t._v(" "+t._s(t.$t("productions.type."+(s.production_type||"short")))+" ")]),e("td",{staticClass:"style"},[t._v(" "+t._s(t.$t("productions.style."+(s.production_style||"3d")))+" ")]),e("td",{staticClass:"fps"},[t._v(" "+t._s(s.fps)+" ")]),e("td",{staticClass:"ratio"},[t._v(" "+t._s(s.ratio)+" ")]),e("td",{staticClass:"resolution"},[t._v(" "+t._s(s.resolution)+" ")]),e("row-actions-cell",{attrs:{"entry-id":s.id},on:{"edit-clicked":function(i){return t.$emit("edit-clicked",s)},"delete-clicked":function(i){return t.$emit("delete-clicked",s)}}})],1)})],2):t._e()])]),e("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),e("p",{staticClass:"has-text-centered nb-productions"},[t._v(" "+t._s(t.entries.length)+" "+t._s(t.$tc("productions.number",t.entries.length))+" ")])],1)},v=[],C=d(f,m,v,!1,null,"d000c473",null,null);const P=C.exports;const g={name:"productions",components:{ButtonLink:h,HardDeleteModal:u,EditProductionModal:p,PageTitle:_,ProductionList:P},data(){return{errors:{del:!1,edit:!1},loading:{del:!1,edit:!1},modals:{isNewDisplayed:!1,isDeleteDisplayed:!1},productionToDelete:null,productionToEdit:null,choices:[]}},computed:{...a(["isProductionsLoading","isProductionsLoadingError","productionAvatarFormData","productions","productionMap"]),currentLockText(){return this.productionToDelete?this.productionToDelete.name:""}},created(){this.loadProductions()},methods:{...r(["deleteProduction","loadProductions","storeProductionPicture","uploadProductionAvatar"]),confirmEditProduction(o){let t="newProduction";const e=this.productionToEdit&&this.productionToEdit.id;e&&(t="editProduction",o.id=this.productionToEdit.id),this.loading.edit=!0,this.errors.edit=!1,this.$store.dispatch(t,o).then(()=>e&&this.productionAvatarFormData?this.uploadProductionAvatar(o.id):Promise.resolve()).then(()=>{this.modals.isNewDisplayed=!1,this.loading.edit=!1}).catch(s=>{console.error(s),this.loading.edit=!1,this.errors.edit=!0})},confirmDeleteProduction(){this.loading.del=!0,this.errors.del=!1,this.deleteProduction(this.productionToDelete).then(()=>{this.modals.isDeleteDisplayed=!1,this.loading.del=!1}).catch(o=>{console.error(o),this.errors.del=!0,this.loading.del=!1})},deleteText(){const o=this.productionToDelete;return o?this.$t("productions.delete_text",{name:o.name}):""},onEditClicked(o){this.productionToEdit=o,this.modals.isNewDisplayed=!0},onDeleteClicked(o){this.productionToDelete=o,this.modals.isDeleteDisplayed=!0},onNewClicked(o){this.productionToEdit={},this.modals.isNewDisplayed=!0},onProductionPictureSelected(o){this.storeProductionPicture(o)}},watch:{},metaInfo(){return{title:`${this.$t("productions.title")} - Kitsu`}}};var $=function(){var t=this,e=t._self._c;return e("div",{staticClass:"productions page fixed-page"},[e("div",{staticClass:"level page-header"},[e("div",{staticClass:"level-left"},[e("page-title",{attrs:{text:t.$t("productions.title")}})],1),e("div",{staticClass:"level-right"},[e("div",{staticClass:"level-item"},[e("button-link",{staticClass:"level-item",attrs:{text:t.$t("productions.new_production"),icon:"plus",path:{name:"new-production"}}})],1)])]),e("production-list",{attrs:{entries:t.productions,"is-loading":t.isProductionsLoading,"is-error":t.isProductionsLoadingError},on:{"delete-clicked":t.onDeleteClicked,"edit-clicked":t.onEditClicked}}),e("edit-production-modal",{attrs:{active:t.modals.isNewDisplayed,"is-loading":t.loading.edit,"is-error":t.errors.edit,"production-to-edit":t.productionToEdit},on:{cancel:function(s){t.modals.isNewDisplayed=!1},fileselected:t.onProductionPictureSelected,confirm:t.confirmEditProduction}}),e("hard-delete-modal",{attrs:{active:t.modals.isDeleteDisplayed,"is-loading":t.loading.del,"is-error":t.errors.del,text:t.deleteText(),"error-text":t.$t("productions.delete_error"),"lock-text":t.currentLockText},on:{cancel:function(s){t.modals.isDeleteDisplayed=!1},confirm:t.confirmDeleteProduction}})],1)},y=[],D=d(g,$,y,!1,null,"7fd19644",null,null);const k=D.exports;export{k as default};
//# sourceMappingURL=Productions-9ae0d85e.js.map
