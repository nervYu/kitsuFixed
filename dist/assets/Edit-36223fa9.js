import{i as o,bf as p,m as l,ay as u,n as c,bN as h,L as v,f,bO as a,bP as n,B as w,h as m,bQ as y,g as _,j as C,aR as g,bR as b,k,P as x,bS as P,bT as E,bU as F,S as $,y as T,l as I,bV as S,bt as M,b as L,aK as D}from"./index-d0b155bb.js";import{e as R,E as N,a as H,b as O,c as A}from"./EntityTaskList-3820433e.js";import"./PeopleNameCell-f77b3a1d.js";const U={name:"previews-per-task-type",components:{ComboboxStyled:o,ValidationTag:p},data(){return{taskTypeId:null,previewFileId:this.entity.preview_file_id}},props:{entityMap:{default:()=>{},type:Map},index:{default:0,type:Number},entity:{default:()=>{},type:Object}},mounted(){this.setCurrentParameters()},computed:{...l(["taskMap","taskTypeMap","taskStatusMap","isCurrentUserManager"]),taskTypeOptions(){return this.entityMap.get(this.entity.id).tasks.map(e=>this.taskMap.get(e)).map(e=>this.taskTypeMap.get(e.task_type_id)).sort(u("priority",1).thenBy("name")).map(e=>({label:e.name,value:e.id}))},previewFileOptions(){return(this.entity.preview_files[this.taskTypeId]||[]).map(e=>({label:`v${e.revision}`,value:e.id}))},taskStatus(){if(!this.entityMap)return"";const i=this.entityMap.get(this.entity.id);if(!i)return"";const e=i.validations.get(this.taskTypeId);if(e){const t=this.taskMap.get(e);return t?this.taskStatusMap.get(t.task_status_id):""}else return""}},methods:{getTaskTypeIdForPreviewFile(i,e){return i.find(t=>this.entity.preview_files[t].some(r=>r.id===e))},setCurrentParameters(){const i=Object.keys(this.entity.preview_files);i.length>0&&(this.entity.preview_file_id&&(this.taskTypeId=this.getTaskTypeIdForPreviewFile(i,this.entity.preview_file_id)),this.taskTypeId||(this.taskTypeId=i[0]))}},watch:{taskTypeId(){const i=this.entity.preview_files[this.taskTypeId];i&&i.length>0?i.some(t=>t.id===this.entity.preview_file_id)?this.previewFileId=this.entity.preview_file_id:this.previewFileId=i[0].id:this.previewFileId=null},previewFileId(){let i=null;const e=this.entity.preview_files[this.taskTypeId];e&&e.length>0&&(i=e.find(t=>t.id===this.previewFileId)),this.$emit("preview-changed",this.entity,i)},"entity.preview_files":function(){},"entity.preview_file_id":function(){this.previewFileId!==this.entity.preview_file_id&&(this.previewFileId=this.entity.preview_file_id)}}};var z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"flexrow"},[e.taskTypeOptions.length>0?t("combobox-styled",{ref:"task-type-combobox",staticClass:"flexrow-item",attrs:{options:e.taskTypeOptions},model:{value:e.taskTypeId,callback:function(s){e.taskTypeId=s},expression:"taskTypeId"}}):e._e(),e.previewFileOptions.length?t("combobox-styled",{staticClass:"flexrow-item",attrs:{options:e.previewFileOptions},model:{value:e.previewFileId,callback:function(s){e.previewFileId=s},expression:"previewFileId"}}):t("span",{staticClass:"text flexrow-item"},[e._v("Selected task has no previews.")]),e.taskStatus?t("div",{staticClass:"flexrow-item"},[t("validation-tag",{staticClass:"flexrow-item",attrs:{task:{task_status_id:e.taskStatus.id},"is-static":!0,thin:!1}})],1):e._e()],1)},j=[],V=c(U,z,j,!1,null,"291aaccb",null,null);const B=V.exports;const K={name:"edit",mixins:[h,v,R,f,a,n],components:{ButtonSimple:w,CornerLeftUpIcon:m,ColorPicker:y,ComboboxStyled:o,ComboboxNumber:_,DescriptionCell:C,DownloadIcon:g,EditEditModal:b,EntityNews:N,EntityPreviewFiles:H,EntityTaskList:O,EntityTimeLogs:A,EntityThumbnail:k,PageSubtitle:x,PencilPicker:P,PreviewRoom:E,PreviewsPerTaskType:B,RawVideoPlayer:F,Schedule:$,Spinner:T,TaskInfo:I,VideoProgress:S},data(){return{currentEdit:null,currentSection:"infos",isLoading:!0,isError:!1,previewRoomRef:"edits-preview-room",previewFileMap:new Map,tempMode:!1,errors:{edit:!1},entityNavOptions:[{label:"Infos",value:"infos"},{label:"Schedule",value:"schedule"},{label:"Preview Files",value:"preview-files"},{label:"Activity",value:"activity"},{label:"Timelog",value:"time-logs"}],modals:{edit:!1}}},mounted(){this.resetData(),this.$on("annotation-changed",this.onAnnotationChanged),this.$options.scrubbing=!1,this.isHd=this.organisation?this.organisation.hd_by_default==="true":!1,this.picturePlayer&&this.picturePlayer.addEventListener("load",async()=>{const i=this.isPlaying;await this.resetPictureCanvas(),this.isPlaying=i}),this.$nextTick(()=>{this.configureEvents(),this.setupFabricCanvas(),this.setPlayerSpeed(1),this.onFrameUpdate(1)})},beforeDestroy(){this.$off("annotation-changed",this.onAnnotationChanged)},computed:{...l(["currentEpisode","currentProduction","getTaskPreviews","getTaskTypePriority","isCurrentUserManager","isTVShow","route","editMap","editMetadataDescriptors","taskMap","taskTypeMap","user"]),title(){return this.currentEdit?this.currentEdit.episode_name?`${this.currentEdit.episode_name} / ${this.currentEdit.name}`:`${this.currentEdit.name}`:"Loading..."},editsPath(){return M(this.currentProduction.id,"edits",this.currentEpisode?this.currentEpisode.id:this.currentEpisode)}},methods:{...L(["editEdit","loadEdits","loadTaskEntityPreviewFiles","updatePreviewAnnotation"]),resetPreviewFileMap(){this.previewFileMap.clear(),this.previewFiles&&Object.values(this.previewFiles).forEach(i=>{i.forEach(e=>{this.previewFileMap.set(e.id,e)})})},resetHeight(){this.$nextTick(()=>{let i=window.innerHeight;i-=this.$refs.header?this.$refs.header.offsetHeight:0,this.$refs["button-bar"]&&(i-=this.$refs["button-bar"].offsetHeight),this.$refs["video-progress"]&&(i-=this.$refs["video-progress"].$el.offsetHeight),this.$refs["info-row"]&&(i-=this.$refs["info-row"].offsetHeight),this.$refs["schedule-row"]&&(i-=this.$refs["schedule-row"].offsetHeight),this.$refs["page-header-row"]&&(i-=this.$refs["page-header-row"].offsetHeight),i=Math.min(window.innerHeight*.4,Math.max(480,i)),this.$refs["video-container"]&&(this.$refs["video-container"].style.height=`${i}px`),!this.isCommentsHidden&&this.$refs["task-info"]&&(this.$refs["task-info"].$el.style.height=`${i}px`),this.rawPlayer&&this.rawPlayer.resetHeight(i),this.$nextTick(()=>{this.resetCanvas(),this.updateProgressBar()})})},initPlayer(){this.currentEdit&&(this.currentPreviewIndex=0,this.playingEntityIndex=0,this.entityList=[{...this.currentEdit,preview_file_id:null,preview_files:this.previewFiles}],this.framesPerImage[0]=this.currentEdit.preview_nb_frames||D,this.pause(),this.rawPlayer&&this.rawPlayer.setCurrentFrame(1),this.currentTimeRaw=0,this.updateProgressBar(),this.updateTaskPanel(),this.clearCanvas(),this.annotations=[],this.resetHeight(),this.resetCanvas().then(()=>{this.isCurrentPreview&&(this.annotations=this.currentEntity.preview_file_annotations,this.loadAnnotation(this.getAnnotation(0)))}))},getCurrentEdit(){return this.editMap.get(this.route.params.edit_id)||null},confirmEditEdit(i){i.id=this.currentEdit.id,this.isLoading=!0,this.errors.edit=!1,this.editEdit(i).then(()=>{this.isLoading=!1,this.modals.edit=!1}).catch(e=>{console.error(e),this.isLoading=!1,this.errors.edit=!0})},setPreviewFile(i){this.playingPreviewFileId=i.id,this.currentEntity.preview_file_id=i.id,this.currentEntity.preview_file_task_id=i.task_id,this.currentEntity.preview_file_extension=i.extension,this.currentEntity.preview_file_annotations=i.annotations||[],this.currentEntity.preview_file_previews=i.previews,this.annotations=this.currentEntity.preview_file_annotations,this.rawPlayer&&this.rawPlayer.reloadCurrentEntity(),this.clearCanvas(),this.updateTaskPanel(),this.updateProgressBar()},onPreviewChanged(i,e){this.pause();const t=this.playingPreviewFileId!==e.id;this.setPreviewFile(e),t&&this.sendUpdatePlayingStatus()},onAnnotationChanged({preview:i,additions:e,deletions:t,updates:s}){const r=i.task_id;this.updatePreviewAnnotation({taskId:r,preview:i,additions:e,deletions:t,updates:s})},scrollToEntity(){},resetData(){this.$nextTick(()=>{this.loadEdits().then(()=>{this.currentEdit=this.getCurrentEdit(),this.currentEdit&&this.loadTaskEntityPreviewFiles(this.currentEdit.id).then(i=>{this.previewFiles=i,this.resetPreviewFileMap(),this.initPlayer(),this.isLoading=!1})})})},onPreviewFilesUpdate(){this.loadTaskEntityPreviewFiles(this.currentEdit.id).then(i=>{this.previewFiles=i,this.currentEntity.preview_files=i,this.resetPreviewFileMap(),this.currentEntity&&this.currentEntity.preview_file_id&&this.previewFileMap.has(this.currentEntity.preview_file_id)})}},watch:{currentProduction(){this.isTVShow||this.resetData()},currentEpisode(){this.isTVShow&&this.editMap.size===0&&this.resetData()},playingPreviewFileId(){if(!this.currentEntity||!this.playingPreviewFileId)return;const i=this.$refs["previews-per-task-type"];if(!i)return;const e=this.currentEntity.preview_files;for(const t in e){const s=e[t].find(r=>r.id===this.playingPreviewFileId);if(s){this.setPreviewFile(s),(i.taskTypeId!==t||i.previewFileId!==this.playingPreviewFileId)&&(i.taskTypeId=t,i.previewFileId=this.playingPreviewFileId);break}}}},socket:{events:{...a.socket.events,...n.socket.events,"preview-file:add-file"(i){if(i.project_id!==this.task.project_id)return;const e=i.task_id,t=this.currentEntity.preview_files;for(const s in t)if(t[s].find(d=>d.task_id===e)){this.onPreviewFilesUpdate();break}},"comment:delete"(i){i.project_id===this.task.project_id&&this.onPreviewFilesUpdate()}}},metaInfo(){return{title:`${this.title} - Kitsu`}}};var G=function(){var e=this,t=e._self._c;return t("div",{staticClass:"columns fixed-page edit xyz-in",attrs:{xyz:"fade"}},[t("div",{staticClass:"column main-column"},[t("div",{ref:"page-header-row",staticClass:"page-header flexrow flexrow-item"},[t("div",{staticClass:"flexrow block mb0 main-block"},[t("router-link",{staticClass:"flexrow-item has-text-centered back-link",attrs:{to:e.editsPath}},[t("corner-left-up-icon")],1),t("span",{staticClass:"flexrow-item"},[e.currentEntity?t("entity-thumbnail",{staticClass:"entity-thumbnail",attrs:{entity:e.currentEntity,"empty-height":60,"empty-width":100,height:60,width:100}}):e._e()],1),t("div",{staticClass:"entity-title flexrow-item mr1"},[e._v(" "+e._s(e.title)+" ")]),!e.isLoading&&e.currentEntity?t("div",{key:e.currentEntity.id,staticClass:"flexrow-item has-text-centered"},[t("previews-per-task-type",{ref:"previews-per-task-type",attrs:{entity:e.currentEntity,"entity-map":e.editMap},on:{"preview-changed":e.onPreviewChanged}})],1):e._e()],1),t("div",{staticClass:"filler"}),t("div",{staticClass:"flexrow-item block mt0"},[e.currentEdit&&e.isValidRoomId(e.currentEdit.id)&&e.currentPreview&&e.currentPreview.id?t("preview-room",{ref:e.previewRoomRef,attrs:{roomId:e.currentEdit&&e.isValidRoomId(e.currentEdit.id)?e.currentEdit.id:"",joinRoom:e.joinRoom,leaveRoom:e.leaveRoom}}):e._e()],1)]),t("div",{ref:"container",staticClass:"edit player block"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading,expression:"!isLoading"}],staticClass:"flexrow filler"},[t("div",{ref:"video-container",staticClass:"flexrow filler video-container"},[t("raw-video-player",{directives:[{name:"show",rawName:"v-show",value:e.isCurrentPreviewMovie&&!e.isLoading,expression:"isCurrentPreviewMovie && !isLoading"}],ref:"raw-player",staticClass:"raw-player",style:{position:"static",opacity:e.overlayOpacity},attrs:{entities:e.entityList,"full-screen":e.fullScreen,"is-hd":e.isHd,"is-repeating":e.isRepeating,"current-preview-index":e.currentPreviewIndex,muted:e.isMuted},on:{"max-duration-update":e.onMaxDurationUpdate,"metadata-loaded":e.onMetadataLoaded,repeat:e.onVideoRepeated,"frame-update":e.onFrameUpdate}}),e.isCurrentPreviewModel&&!e.isLoading?t("object-viewer",{ref:"object-player",staticClass:"object-player",style:{position:"static",opacity:e.overlayOpacity},attrs:{"preview-url":e.currentPreviewDlPath,"full-screen":e.fullScreen}}):e._e(),e.isCurrentPreviewSound&&!e.isLoading?t("sound-viewer",{ref:"sound-player",staticClass:"sound-player",attrs:{"preview-url":e.currentPreviewDlPath,"full-screen":e.fullScreen},on:{"play-ended":e.pause}}):e._e(),t("p",{directives:[{name:"show",rawName:"v-show",value:e.isCurrentPreviewFile&&!e.isLoading,expression:"isCurrentPreviewFile && !isLoading"}],staticClass:"preview-standard-file has-text-centered",style:{width:"100%"}},[e.extension&&e.extension.length>0?t("a",{ref:"preview-file",staticClass:"button",attrs:{href:e.currentPreviewDlPath}},[t("download-icon",{staticClass:"icon"}),t("span",{staticClass:"text"},[e._v(" "+e._s(e.$t("tasks.download_pdf_file",{extension:e.extension}))+" ")])],1):e._e()]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isCurrentPreviewPicture&&!e.isLoading,expression:"isCurrentPreviewPicture && !isLoading"}],ref:"picture-player-wrapper",staticClass:"picture-preview-wrapper flexrow",style:{position:"static",opacity:e.overlayOpacity,left:0,right:0}},[t("img",{directives:[{name:"show",rawName:"v-show",value:e.isCurrentPreviewPicture,expression:"isCurrentPreviewPicture"}],ref:"picture-player",staticClass:"picture-preview",attrs:{id:"picture-player",src:e.isCurrentPreviewPicture?e.currentPreviewPath:null}})]),e.isLoading?t("div",{staticClass:"loading-wrapper"},[t("spinner")],1):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isCurrentPreviewFile,expression:"!isCurrentPreviewFile"}],ref:"canvas-wrapper",staticClass:"canvas-wrapper",attrs:{oncontextmenu:"return false;"}},[t("canvas",{ref:"annotation-canvas",staticClass:"canvas",attrs:{id:"edit-annotation-canvas"}})])],1),t("task-info",{ref:"task-info",class:{"flexrow-item":!0,"task-info-column":!0,hidden:e.isCommentsHidden},attrs:{task:e.task,"is-preview":!1,silent:e.isCommentsHidden,"current-time-raw":e.currentTimeRaw-e.frameDuration,"current-parent-preview":e.currentPreview},on:{"time-code-clicked":e.onTimeCodeClicked}})],1),t("video-progress",{directives:[{name:"show",rawName:"v-show",value:e.isCurrentPreviewMovie&&e.currentPreview.id,expression:"isCurrentPreviewMovie && currentPreview.id"}],ref:"video-progress",staticClass:"video-progress pull-bottom",attrs:{annotations:e.annotations,"frame-duration":e.frameDuration,"nb-frames":e.nbFrames,"handle-in":-1,"handle-out":-1},on:{"start-scrub":e.onScrubStart,"end-scrub":e.onScrubEnd,"progress-changed":e.onProgressChanged}}),e.currentEntity&&e.currentEntity.id?t("div",{ref:"button-bar",staticClass:"player-footer flexrow"},[e.isCurrentPreviewMovie||e.isCurrentPreviewPicture||e.isCurrentPreviewSound?t("div",{staticClass:"flexrow flexrow-item mr0"},[e.isPlaying?t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{title:e.$t("playlists.actions.pause"),icon:"pause"},on:{click:e.pauseClicked}}):t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{title:e.$t("playlists.actions.play"),icon:"play"},on:{click:e.playClicked}})],1):e._e(),t("div",{staticClass:"separator"}),e.isCurrentPreviewPicture?[e._v(" "+e._s(e.framesSeenOfPicture)+" / "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.framesPerImage[e.playingEntityIndex],expression:"framesPerImage[playingEntityIndex]"}],staticClass:"frame-per-image-input",attrs:{type:"number",min:"0",title:e.$t("playlists.actions.frames_per_picture")},domProps:{value:e.framesPerImage[e.playingEntityIndex]},on:{input:function(s){s.target.composing||e.$set(e.framesPerImage,e.playingEntityIndex,s.target.value)}}})]:e._e(),e.isCurrentPreviewPicture?t("div",{staticClass:"separator"}):e._e(),e.currentEntityPreviewLength>1?t("div",{staticClass:"flexrow flexrow-item"},[t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{icon:"left",title:e.$t("playlists.actions.files_previous"),disabled:e.isPlaying},on:{click:e.onPreviousPreviewClicked}}),t("span",{staticClass:"ml05 mr05",attrs:{title:e.$t("playlists.actions.files_position")}},[e._v(" "+e._s(e.currentPreviewIndex+1)+" / "+e._s(e.currentEntityPreviewLength)+" ")]),t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{icon:"right",title:e.$t("playlists.actions.files_next"),disabled:e.isPlaying},on:{click:e.onNextPreviewClicked}}),t("a",{staticClass:"button player-button flexrow-item",attrs:{href:e.currentPreviewPath,title:e.$t("playlists.actions.see_original_file"),target:"blank"}},[t("arrow-up-right-icon",{staticClass:"icon is-small"})],1)],1):e._e(),e.isCurrentPreviewMovie?t("div",{staticClass:"flexrow flexrow-item"},[e.speed===3?t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{title:e.$t("playlists.actions.speed"),text:"x1.00"},on:{click:e.onSpeedClicked}}):e.speed===2?t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{title:e.$t("playlists.actions.speed"),text:"x0.50"},on:{click:e.onSpeedClicked}}):t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{title:e.$t("playlists.actions.speed"),text:"x0.25"},on:{click:e.onSpeedClicked}}),e.isMuted?t("button-simple",{staticClass:"flexrow-item player-button",attrs:{title:e.$t("playlists.actions.unmute"),icon:"soundoff"},on:{click:e.onToggleSoundClicked}}):t("button-simple",{staticClass:"flexrow-item player-button",attrs:{title:e.$t("playlists.actions.mute"),icon:"soundon"},on:{click:e.onToggleSoundClicked}}),t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{active:e.isRepeating,title:e.$t("playlists.actions.looping"),icon:"repeat"},on:{click:e.onRepeatClicked}}),t("span",{staticClass:"flexrow-item time-indicator",attrs:{title:e.$t("playlists.actions.current_time")}},[e._v(" "+e._s(e.currentTime)+" ")]),t("span",{staticClass:"flexrow-item time-indicator"},[e._v(" / ")]),t("span",{staticClass:"flexrow-item time-indicator",attrs:{title:e.$t("playlists.actions.max_duration")}},[e._v(" "+e._s(e.maxDuration)+" ")]),t("span",{staticClass:"flexrow-item time-indicator mr1",attrs:{title:e.$t("playlists.actions.frame_number")}},[e._v(" ("+e._s(e.currentFrame)+" / "+e._s((e.nbFrames+"").padStart(3,"0"))+") ")]),t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{title:e.$t("playlists.actions.previous_frame"),icon:"left"},on:{click:e.onPreviousFrameClicked}}),t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{title:e.$t("playlists.actions.next_frame"),icon:"right"},on:{click:e.onNextFrameClicked}})],1):e._e(),t("span",{staticClass:"filler"}),!e.isCurrentUserArtist&&(e.isCurrentPreviewMovie||e.isCurrentPreviewPicture)?t("div",{staticClass:"flexrow"},[t("button-simple",{staticClass:"player-button flexrow-item",attrs:{icon:"undo",title:e.$t("playlists.actions.annotation_undo")},on:{click:e.undoLastAction}}),t("button-simple",{staticClass:"player-button flexrow-item",attrs:{title:e.$t("playlists.actions.annotation_redo"),icon:"redo"},on:{click:e.redoLastAction}}),t("transition",{attrs:{name:"slide"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isTyping,expression:"isTyping"}],staticClass:"annotation-tools"},[t("color-picker",{attrs:{isOpen:e.isShowingPalette,color:this.textColor},on:{TogglePalette:e.onPickColor,change:e.onChangeTextColor}})],1)]),t("button-simple",{class:{"player-button":!0,"flexrow-item":!0,active:e.isTyping},attrs:{title:e.$t("playlists.actions.annotation_text"),icon:"type"},on:{click:e.onTypeClicked}}),t("transition",{attrs:{name:"slide"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isDrawing,expression:"isDrawing"}],staticClass:"annotation-tools"},[t("pencil-picker",{attrs:{isOpen:e.isShowingPencilPalette,pencil:e.pencil,sizes:this.pencilPalette},on:{"toggle-palette":e.onPickPencil,change:e.onChangePencil}}),t("color-picker",{attrs:{isOpen:e.isShowingPalette,color:this.color},on:{TogglePalette:e.onPickColor,change:e.onChangeColor}})],1)]),t("button-simple",{class:{"player-button":!0,"flexrow-item":!0,active:e.isDrawing},attrs:{title:e.$t("playlists.actions.annotation_draw"),icon:"pencil"},on:{click:e.onAnnotateClicked}}),t("button-simple",{staticClass:"player-button flexrow-item",attrs:{icon:"remove",title:e.$t("playlists.actions.annotation_delete")},on:{click:e.onDeleteClicked}})],1):e._e(),t("div",{staticClass:"separator"}),t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{title:e.$t("playlists.actions.comments"),icon:"comment"},on:{click:e.onCommentClicked}}),e.isCurrentPreviewMovie?t("button-simple",{staticClass:"player-button flexrow-item",attrs:{title:e.$t("playlists.actions."+(e.isHd?"switch_ld":"switch_hd")),text:e.isHd?"HD":"LD"},on:{click:function(s){e.isHd=!e.isHd}}}):e._e(),e.isFullScreenEnabled?t("button-simple",{staticClass:"button player-button flexrow-item",attrs:{title:e.$t("playlists.actions.fullscreen"),icon:"maximize"},on:{click:e.onFullscreenClicked}}):e._e()],2):e._e()],1),t("div",{staticClass:"edit-data block"},[t("div",{staticClass:"flexrow"},[t("combobox-styled",{staticClass:"section-combo flexrow-item",attrs:{options:e.entityNavOptions},model:{value:e.currentSection,callback:function(s){e.currentSection=s},expression:"currentSection"}}),t("div",{staticClass:"filler"}),t("span",{directives:[{name:"show",rawName:"v-show",value:e.currentSection==="schedule",expression:"currentSection === 'schedule'"}],staticClass:"flexrow-item mt05"},[e._v(" "+e._s(e.$t("schedule.zoom_level"))+": ")]),t("combobox-number",{directives:[{name:"show",rawName:"v-show",value:e.currentSection==="schedule",expression:"currentSection === 'schedule'"}],staticClass:"zoom-level flexrow-item",attrs:{options:e.zoomOptions,"is-simple":""},model:{value:e.zoomLevel,callback:function(s){e.zoomLevel=s},expression:"zoomLevel"}})],1),e.currentSection==="infos"?t("div",{ref:"info-row",staticClass:"infos flexrow pa0"},[t("div",{staticClass:"flexrow-item"},[t("div",{staticClass:"flexrow"},[t("div",{staticClass:"flexcolumn flexrow-item"},[t("page-subtitle",{staticClass:"flerow-item",attrs:{text:e.$t("edits.tasks")}}),t("entity-task-list",{staticClass:"task-list flexrow-item",attrs:{entries:e.currentEdit?e.currentEdit.tasks:[],"is-loading":!e.currentEdit,"is-error":!1}})],1),t("div",{staticClass:"flexcolumn flexrow-item"},[t("div",{staticClass:"flexrow"},[t("page-subtitle",{staticClass:"flerow-item",attrs:{text:e.$t("main.info")}}),t("div",{staticClass:"flexrow-item has-text-right"},[e.isCurrentUserManager?t("button-simple",{attrs:{icon:"edit"},on:{click:function(s){e.modals.edit=!0}}}):e._e()],1)],1),t("div",{staticClass:"table-body edit-metadata flexrow-item"},[e.currentEdit?t("table",{staticClass:"datatable no-header"},[t("tbody",{staticClass:"datatable-body"},[t("tr",{staticClass:"datatable-row"},[t("td",{staticClass:"field-label"},[e._v(e._s(e.$t("edits.fields.description")))]),t("description-cell",{attrs:{entry:e.currentEdit,full:!0}})],1),e._l(e.editMetadataDescriptors,function(s){return t("tr",{key:s.id,staticClass:"datatable-row"},[t("td",{staticClass:"field-label"},[e._v(e._s(s.name))]),t("td",[e._v(" "+e._s(e.currentEdit.data?e.currentEdit.data[s.field_name]:"")+" ")])])})],2)]):e._e()])])])])]):e._e(),e.currentSection==="schedule"&&e.scheduleItems.length>0?t("div",{ref:"schedule-row",staticClass:"infos schedule"},[e.scheduleItems[0].children.length>0?t("div",{directives:[{name:"show",rawName:"v-show",value:e.currentSection==="schedule",expression:"currentSection === 'schedule'"}],staticClass:"schedule mt1"},[t("div",{staticClass:"wrapper"},[t("schedule",{ref:"schedule-widget",attrs:{"start-date":e.tasksStartDate,"end-date":e.tasksEndDate,hierarchy:e.scheduleItems,"zoom-level":e.zoomLevel,"is-loading":!1,"is-estimation-linked":!0,"hide-root":!0,"with-milestones":!1}})],1)]):e._e()]):e._e(),e.currentSection==="preview-files"?t("entity-preview-files",{attrs:{entity:e.currentEdit}}):e._e(),e.currentSection==="activity"?t("entity-news",{attrs:{entity:e.currentEdit}}):e._e(),e.currentSection==="time-logs"?t("entity-time-logs",{attrs:{entity:e.currentEdit}}):e._e()],1)]),t("edit-edit-modal",{ref:"edit-edit-modal",attrs:{active:e.modals.edit,"is-loading":e.isLoading,"is-error":e.errors.edit,"edit-to-edit":e.currentEdit},on:{cancel:function(s){e.modals.edit=!1},confirm:e.confirmEditEdit}})],1)},Q=[],q=c(K,G,Q,!1,null,"13a34101",null,null);const Y=q.exports;export{Y as default};
//# sourceMappingURL=Edit-36223fa9.js.map
