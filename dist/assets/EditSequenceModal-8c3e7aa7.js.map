{"version":3,"file":"EditSequenceModal-8c3e7aa7.js","sources":["../../src/components/modals/EditSequenceModal.vue"],"sourcesContent":["<template>\n<div :class=\"{\n  'modal': true,\n  'is-active': active\n}\">\n  <div class=\"modal-background\" @click=\"$emit('cancel')\" ></div>\n\n  <div class=\"modal-content\">\n    <div class=\"box\">\n\n      <h1 class=\"title\" v-if=\"sequenceToEdit && this.sequenceToEdit.id\">\n        {{ $t(\"sequences.edit_title\") }} {{ sequenceToEdit.name }}\n      </h1>\n      <h1 class=\"title\" v-else>\n        {{ $t(\"sequences.new_sequence\") }}\n      </h1>\n\n      <form v-on:submit.prevent>\n        <text-field\n          ref=\"nameField\"\n          :label=\"$t('sequences.fields.name')\"\n          v-model=\"form.name\"\n          @enter=\"runConfirmation\"\n          v-focus\n        />\n        <textarea-field\n          ref=\"descriptionField\"\n          :label=\"$t('sequences.fields.description')\"\n          @keyup.ctrl.enter=\"runConfirmation\"\n          @keyup.meta.enter=\"runConfirmation\"\n          v-model=\"form.description\"\n        />\n\n        <div\n          :key=\"descriptor.id\"\n          v-for=\"descriptor in sequenceMetadataDescriptors\"\n        >\n          <combobox\n            v-if=\"descriptor.choices.length > 0\"\n            :label=\"descriptor.name\"\n            :options=\"getDescriptorChoicesOptions(descriptor)\"\n            v-model=\"form.data[descriptor.field_name]\"\n          />\n          <text-field\n            :label=\"descriptor.name\"\n            @enter=\"runConfirmation\"\n            v-model=\"form.data[descriptor.field_name]\"\n            v-else\n          />\n        </div>\n      </form>\n\n      <modal-footer\n        :error-text=\"$t('sequences.edit_error')\"\n        :is-loading=\"isLoading\"\n        :is-error=\"isError\"\n        @confirm=\"runConfirmation\"\n        @cancel=\"$emit('cancel')\"\n      />\n    </div>\n  </div>\n</div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\nimport { modalMixin } from '@/components/modals/base_modal'\nimport Combobox from '@/components/widgets/Combobox'\nimport ModalFooter from '@/components/modals/ModalFooter'\nimport TextField from '@/components/widgets/TextField'\nimport TextareaField from '@/components/widgets/TextareaField'\n\nexport default {\n  name: 'edit-sequence-modal',\n  mixins: [modalMixin],\n  components: {\n    Combobox,\n    ModalFooter,\n    TextField,\n    TextareaField\n  },\n\n  props: {\n    active: {\n      type: Boolean,\n      default: false\n    },\n    isError: {\n      type: Boolean,\n      default: false\n    },\n    isLoading: {\n      type: Boolean,\n      default: false\n    },\n    sequenceToEdit: {\n      type: Object,\n      default: () => {}\n    }\n  },\n\n  data () {\n    if (this.sequenceToEdit && this.sequenceToEdit.id) {\n      return {\n        form: {\n          id: this.sequenceToEdit.id,\n          name: this.sequenceToEdit.name,\n          description: this.sequenceToEdit.description,\n          production_id: this.sequenceToEdit.project_id,\n          data: this.sequenceToEdit.data || {}\n        },\n        sequenceSuccessText: ''\n      }\n    } else {\n      return {\n        form: {\n          id: '',\n          name: '',\n          description: '',\n          data: {}\n        },\n        sequenceSuccessText: ''\n      }\n    }\n  },\n\n  computed: {\n    ...mapGetters([\n      'currentProduction',\n      'sequenceMetadataDescriptors'\n    ])\n  },\n\n  methods: {\n    ...mapActions([\n    ]),\n\n    getDescriptorChoicesOptions (descriptor) {\n      const values = descriptor.choices.map(c => ({ label: c, value: c }))\n      return [{ label: '', value: '' }, ...values]\n    },\n\n    runConfirmation () {\n      this.confirmClicked()\n    },\n\n    confirmClicked () {\n      this.$emit('confirm', this.form)\n    },\n\n    isEditing () {\n      return this.sequenceToEdit && this.sequenceToEdit.id\n    },\n\n    resetForm () {\n      this.sequenceSuccessText = ''\n      if (!this.isEditing()) {\n        this.form.id = null\n        this.form.name = ''\n        this.form.description = ''\n      } else {\n        this.form = {\n          id: this.sequenceToEdit.id,\n          name: this.sequenceToEdit.name,\n          description: this.sequenceToEdit.description,\n          data: this.sequenceToEdit.data || {}\n        }\n      }\n    }\n  },\n\n  mounted () {\n    if (this.active) {\n      this.resetForm()\n    }\n  },\n\n  watch: {\n    active () {\n      this.resetForm()\n    },\n\n    sequenceToEdit () {\n      this.resetForm()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.modal-content .box p.text {\n  margin-bottom: 1em;\n}\n.is-danger {\n  color: #ff3860;\n  font-style: italic;\n}\n.info-message {\n  margin-top: 1em;\n}\n</style>\n"],"names":["_sfc_main","modalMixin","Combobox","ModalFooter","TextField","TextareaField","mapGetters","mapActions","descriptor","values","c"],"mappings":"0FAwEA,MAAAA,EAAA,CACA,KAAA,sBACA,OAAA,CAAAC,CAAA,EACA,WAAA,CACA,SAAAC,EACA,YAAAC,EACA,UAAAC,EACA,cAAAC,CACA,EAEA,MAAA,CACA,OAAA,CACA,KAAA,QACA,QAAA,EACA,EACA,QAAA,CACA,KAAA,QACA,QAAA,EACA,EACA,UAAA,CACA,KAAA,QACA,QAAA,EACA,EACA,eAAA,CACA,KAAA,OACA,QAAA,IAAA,CAAA,CACA,CACA,EAEA,MAAA,CACA,OAAA,KAAA,gBAAA,KAAA,eAAA,GACA,CACA,KAAA,CACA,GAAA,KAAA,eAAA,GACA,KAAA,KAAA,eAAA,KACA,YAAA,KAAA,eAAA,YACA,cAAA,KAAA,eAAA,WACA,KAAA,KAAA,eAAA,MAAA,CAAA,CACA,EACA,oBAAA,EACA,EAEA,CACA,KAAA,CACA,GAAA,GACA,KAAA,GACA,YAAA,GACA,KAAA,CAAA,CACA,EACA,oBAAA,EACA,CAEA,EAEA,SAAA,CACA,GAAAC,EAAA,CACA,oBACA,6BACA,CAAA,CACA,EAEA,QAAA,CACA,GAAAC,EAAA,CACA,CAAA,EAEA,4BAAAC,EAAA,CACA,MAAAC,EAAAD,EAAA,QAAA,IAAAE,IAAA,CAAA,MAAAA,EAAA,MAAAA,CAAA,EAAA,EACA,MAAA,CAAA,CAAA,MAAA,GAAA,MAAA,EAAA,EAAA,GAAAD,CAAA,CACA,EAEA,iBAAA,CACA,KAAA,eAAA,CACA,EAEA,gBAAA,CACA,KAAA,MAAA,UAAA,KAAA,IAAA,CACA,EAEA,WAAA,CACA,OAAA,KAAA,gBAAA,KAAA,eAAA,EACA,EAEA,WAAA,CACA,KAAA,oBAAA,GACA,KAAA,YAKA,KAAA,KAAA,CACA,GAAA,KAAA,eAAA,GACA,KAAA,KAAA,eAAA,KACA,YAAA,KAAA,eAAA,YACA,KAAA,KAAA,eAAA,MAAA,CAAA,CACA,GATA,KAAA,KAAA,GAAA,KACA,KAAA,KAAA,KAAA,GACA,KAAA,KAAA,YAAA,GASA,CACA,EAEA,SAAA,CACA,KAAA,QACA,KAAA,UAAA,CAEA,EAEA,MAAA,CACA,QAAA,CACA,KAAA,UAAA,CACA,EAEA,gBAAA,CACA,KAAA,UAAA,CACA,CACA,CACA"}